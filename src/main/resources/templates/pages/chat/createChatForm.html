<!DOCTYPE html>
<!-- Default Layout Import-->
<html lang="en"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{common/layout/defaultLayout}"
      layout:fragment="Content">
    <head>
        <script src="https://kit.fontawesome.com/7d4169cb69.js" crossorigin="anonymous"></script>
        <!-- 태그 라이브러리 다운-->
        <!-- 소스 다운 -->
        <script src="https://unpkg.com/@yaireo/tagify"></script>
        <!-- 폴리필 (구버젼 브라우저 지원) -->
        <script src="https://unpkg.com/@yaireo/tagify/dist/tagify.polyfills.min.js"></script>
        <link href="https://unpkg.com/@yaireo/tagify/dist/tagify.css" rel="stylesheet" type="text/css" />
        <title>채팅방 개설</title>
        <!-- inline CSS 영역-->
        <style th:inline="css" type="text/css">
            .createChat-main{
                width: 100%;
                height: 800px;
                background-color: #ececec;
                display: flex;
                flex-direction: row;
                justify-content: center;
                user-select:none;
            }
            .list-title{
                width: 100%;
                height: 60px;
                font-weight: 500;
                color: white;
                font-size: 25px;
                background-color:black;
                line-height: 60px;
                text-align: center;
            }

            .movie-list-container{
                width: 50%;
                height: 100%;
                background-color:white;
            }
            .region-list-container{
                width: 25%;
                height: 100%;
                /*background-color: #ececec;*/
                background-color: white;
            }
            .cinema-list-container{
                width: 25%;
                height: 100%;
                /*background-color:#ececec;*/
                background-color: white;
            }

            .movie-item-content{
                display: flex;
                /*margin: 15px;*/
                position: relative;
                /*border: 3px solid #EA4E4A;*/
                padding: 15px;
                cursor: pointer;
            }
            .selectedMovie{
                border: 3px solid #EA4E4A;
                padding:12px;
                background-color:white;
            }
            .selectedMovie .movie-title{
                color: #EA4E4A;
            }
            .movie-img{
                width: 150px;
                height: 200px;
                border-radius: 20px;
                background-color:gray;
                margin-right: 20px;
            }

            .check-icon{
                opacity: 0;
                position: absolute;
                right: 10px;
                top: 10px;
                color: #EA4E4A;
                font-size: 30px
            }
            .check-icon.checked{
                opacity: 1;
            }


            /*지역선택*/
               .regionBox{
                   font-size: 20px;
                   width: 100%;
                   height: 70px;
                   line-height: 70px;
                   cursor: pointer;
                   padding-left: 20px;
                   position: relative;
               }
               .checkedRegion{
                   border: 3px solid #EA4E4A;
                   /*background-color:#ececec;*/
                   color: #EA4E4A;
                   font-weight: bold;
               }
               .region-check-icon{
                   opacity: 0;
                   position: absolute;
                   right: 20px;
                   top: -4px;
                   color: #EA4E4A;
                   font-size: 30px;
               }
               .region-check-icon.checked{
                   opacity: 1;
               }


            /* 극장선택 */
            .cinemaBox{
                font-size: 20px;
                width: 100%;
                height: 70px;
                line-height: 70px;
                cursor: pointer;
                padding-left: 20px;
                position: relative;
            }
            .checkedCinema{
                border: 3px solid #EA4E4A;
                /*background-color:#ececec;*/
                color: #EA4E4A;
                font-weight: bold;
            }
            .cinema-check-icon{
                opacity: 0;
                position: absolute;
                right: 20px;
                top: -4px;
                color: #EA4E4A;
                font-size: 30px;
            }
            .cinema-check-icon.checked{
                opacity: 1;
            }

        /*  채팅방 정보  */
            .chatRoom-info{
                font-size: 25px;
                width: 80%;
                margin: 0 auto;
            }
            .charRoom-info-nameBox{
                display: flex;
                border-bottom:2px solid gray;
                height: 50px;
                margin-bottom: 10px;
            }
            .charRoom-info-nameBox input{
                font-size: 25px;
                border: none;
                width: 93%;
                outline: none;
                padding-left: 17px;
            }
            .charRoom-info-nameBox:focus-within{
                border-bottom:2px solid black;
            }

        /*   태그 css*/
            .tagify{
                border: none;
                border-bottom: 2px solid gray;
                min-width:100%;
                font-size: 20px;
            }
        </style>

        <!-- inline JS 영역-->
        <script th:inline="javascript" type="text/javascript">

            // 영화 리스트 선택
                // 전체 체크 해제
            function unSelectedAll(){
                let movieSelectedItem = document.querySelectorAll('.movie-item-content');
                let checkedIcon = document.querySelectorAll('.check-icon');

                movieSelectedItem.forEach((item)=>{
                    item.classList.remove("selectedMovie");
                });
                checkedIcon.forEach((item)=>{
                    item.classList.remove("checked");
                });
            }

                // onclick function 체크되면 체크박스 생성
            function selectMovie(div){
                if(div.classList.contains("selectedMovie")){
                    unSelectedAll(); // 전체 체크 해제 - 영화
                    unSelectedRegion(); // 전체 체크 해제 - 지역
                    unSelectedCinema(); // 전체 체크 해제 - 극장
                    div.classList.remove("selectedMovie");
                    div.children[2].classList.remove('checked');
                }else{
                    unSelectedAll(); // 전체 체크 해제 - 영화
                    unSelectedRegion(); // 전체 체크 해제 - 지역
                    unSelectedCinema(); // 전체 체크 해제 - 극장
                    div.classList.add("selectedMovie");
                    div.children[2].classList.add('checked');
                }
            }

            // 지역 선택
                // 전체 체크 해제 - 지역
            function unSelectedRegion(){
                let regionBoxAll = document.querySelectorAll('.regionBox');
                let regionCheckedIcon = document.querySelectorAll('.region-check-icon');

                regionBoxAll.forEach((item)=>{
                    item.classList.remove("checkedRegion");
                });
                regionCheckedIcon.forEach((item)=>{
                    item.classList.remove("checked");
                });
            }
                // onclick function 체크되면 체크박스 생성 - 지역
            function selectRegion(div){
                let movieAll = document.querySelectorAll('.movie-item-content');
                let count = 0;
                movieAll.forEach(item => {
                    if(item.classList.contains('selectedMovie')){
                        count++;
                    }
                })
                if(count <= 0){
                    alert('영화를 먼저 선택해주세요!');
                }else{
                    if(div.classList.contains("checkedRegion")){
                        unSelectedRegion(); // 전체 체크 해제 - 지역
                        unSelectedCinema(); // 전체 체크 해제 - 극장
                        div.classList.remove("checkedRegion");
                        div.children[1].classList.remove('checked');
                    }else{
                        unSelectedRegion(); // 전체 체크 해제 - 지역
                        unSelectedCinema(); // 전체 체크 해제 - 극장
                        div.classList.add("checkedRegion");
                        div.children[1].classList.add('checked');
                    }
                }

            }

            // 전체 체크 해제 - 극장
            function unSelectedCinema(){
                let cinemaBoxAll = document.querySelectorAll('.cinemaBox');
                let cinemaCheckedIcon = document.querySelectorAll('.cinema-check-icon');

                cinemaBoxAll.forEach((item)=>{
                    item.classList.remove("checkedCinema");
                });

                cinemaCheckedIcon.forEach((item)=>{
                    item.classList.remove("checked");
                });
            }

            // onclick function 체크되면 체크박스 생성 - 극장
            function selectCinema(div){
                let regionAll = document.querySelectorAll('.regionBox');
                let count = 0;
                regionAll.forEach(item => {
                    if(item.classList.contains('checkedRegion')){
                        count++;
                    }
                })
                if(count <= 0){
                    alert('지역을 먼저 선택해주세요!');
                }else {
                    if (div.classList.contains("checkedCinema")) {
                        unSelectedCinema(); // 전체 체크 해제
                        div.classList.remove("checkedCinema");
                        div.children[1].classList.remove('checked');
                    } else {
                        unSelectedCinema(); // 전체 체크 해제
                        div.classList.add("checkedCinema");
                        div.children[1].classList.add('checked');
                    }
                }
            }

            // 채팅방 정보
            function changeLengthCount(){
                let nameLength = document.querySelector('input[name=roomName]').value.length;
                if(nameLength <= 30){
                    document.querySelector('.roomName-length').innerHTML = nameLength;
                }
            }


            // 로드 후 실행
            window.addEventListener('load', ()=>{
            /////////태그 js
                const input = document.querySelector('input[name=boardTagName]');
                let tagify = new Tagify(input); // Tagify 초기화

                // 태그가 추가되면 이벤트 발생
                tagify.on('add', function() {
                    console.log(tagify.value); // 입력된 태그 정보 객체(배열)
                    console.log(tagify.value[0].value) // 태그 배열 0번째 객체의 value값 -> 입력한 태그
                })
            });



        </script>

    </head>
    <body>
        <div class="createChat-main">
            <div class="movie-list-container">
                <div class="list-title" style="border-right:1px solid gray;">영화선택</div>
                <div class="movie-list-content">
<!--                    moive 리스트 가져오기-->
                    <div class="movie-item-content" id="content1" onclick="selectMovie(this);">
                        <div class="movie-img">
                            <img src="" alt="영화이미지">
                        </div>
                        <div style="display: flex; flex-direction: column; justify-content: center">
                            <div style="font-size: 27px; font-weight: bold; height: 60%">
                                <span>15세</span>
                                <span class="movie-title">베테랑2</span>
                            </div>
                            <div>
                                <span>시계</span>
                                <span style="font-size: 20px">118분</span>
                            </div>
                            <div>
                                <span style="font-size: 16px" th:text="'개봉일 2024.09.13'"></span>
                            </div>
                        </div>
                        <div class="check-icon">
                            <i class="fa-solid fa-check"></i>
                        </div>
                    </div>
                    <div class="movie-item-content" id="content2" onclick="selectMovie(this)">
                        <div class="movie-img">
                            <img src="" alt="영화이미지">
                        </div>
                        <div style="display: flex; flex-direction: column; justify-content: center">
                            <div style="font-size: 27px; font-weight: bold; height: 60%">
                                <span>15세</span>
                                <span>베테랑2</span>
                            </div>
                            <div>
                                <span>시계</span>
                                <span style="font-size: 20px">118분</span>
                            </div>
                            <div>
                                <span style="font-size: 16px" th:text="'개봉일 2024.09.13'"></span>
                            </div>
                        </div>
                        <div class="check-icon">
                            <i class="fa-solid fa-check"></i>
                        </div>
                    </div>
                </div>
            </div>

            <div class="region-list-container">
                <div class="list-title">지역선택</div>
                <div class="regionBox" onclick="selectRegion(this)">
                    <span th:text="'서울()'"></span>
                    <div class="region-check-icon">
                        <i class="fa-solid fa-check"></i>
                    </div>
                </div>
                <div class="regionBox" onclick="selectRegion(this)">
                    <span th:text="'경기/인천()'"></span>
                    <div class="region-check-icon">
                        <i class="fa-solid fa-check"></i>
                    </div>
                </div>
                <div class="regionBox" onclick="selectRegion(this)">
                    <span th:text="'충청/대전()'"></span>
                    <div class="region-check-icon">
                        <i class="fa-solid fa-check"></i>
                    </div>
                </div>
                <div class="regionBox" onclick="selectRegion(this)">
                    <span th:text="'전라/광주()'"></span>
                    <div class="region-check-icon">
                        <i class="fa-solid fa-check"></i>
                    </div>
                </div>
                <div class="regionBox" onclick="selectRegion(this)">
                    <span th:text="'경북/대구()'"></span>
                    <div class="region-check-icon">
                        <i class="fa-solid fa-check"></i>
                    </div>
                </div>
                <div class="regionBox" onclick="selectRegion(this)">
                    <span th:text="'경남/부산/울산()'"></span>
                    <div class="region-check-icon">
                        <i class="fa-solid fa-check"></i>
                    </div>
                </div>
                <div class="regionBox" onclick="selectRegion(this)">
                    <span th:text="'강원()'"></span>
                    <div class="region-check-icon">
                        <i class="fa-solid fa-check"></i>
                    </div>
                </div>
                <div class="regionBox" onclick="selectRegion(this)">
                    <span th:text="'제주()'"></span>
                    <div class="region-check-icon">
                        <i class="fa-solid fa-check"></i>
                    </div>
                </div>
            </div>

            <div class="cinema-list-container">
                <div class="list-title" style="border-left:1px solid gray;">극장선택</div>
                <div class="cinemaBox" onclick="selectCinema(this)">
                    <span th:text="'가산디지털'"></span>
                    <div class="cinema-check-icon">
                        <i class="fa-solid fa-check"></i>
                    </div>
                </div>
                <div class="cinemaBox" onclick="selectCinema(this)">
                    <span th:text="'가산디지털'"></span>
                    <div class="cinema-check-icon">
                        <i class="fa-solid fa-check"></i>
                    </div>
                </div>
            </div>



        </div>
        <div>채팅방 정보 입력</div>
        <div class="chatRoom-info">
            <div class="charRoom-info-nameBox">
                <input type="text" name="roomName" placeholder="채팅방 이름을 입력해 주세요" maxlength="30" oninput="changeLengthCount();">
                <div style="color: gray;">
                    <span class="roomName-length">0</span>
                    <span>/30</span>
                </div>
            </div>
            <label>
                <input type="text" name="boardTagName" placeholder="해시태그로 채팅방을 소개해보세요">
            </label>
        </div>

        <form action="/chat/create" method="post">
    <!--        카테고리 -> 이미 선택하고 들어옴-->
    <!--        영화선택-->
            <input type="hidden" name="movieNo" value="">
    <!--        지역선택-->
            <input type="hidden" name="cinemaLocationCode" value="">
    <!--        극장선택-->
            <input type="hidden" name="cinemaNo" value="">




        </form>
        <!--        상세페이지-->
        <!--        날짜선택-->
        <!--        시간선택-->

    </body>
</html>