<!DOCTYPE html>
<!-- Default Layout Import-->
<html lang="en"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{common/layout/defaultLayout}"
      layout:fragment="Content">
<link rel="stylesheet" href="/css/movie/adminMovieDetail.css">

<body>
<div layout:fragment="content">
  <!-- 여기에 기존의 main 태그 내용을 넣습니다 -->
  <main>
    <h1>영화 등록</h1>

    <div class="detail-area" th:if="${not #lists.isEmpty(movieInfo)}">
      <div th:each="movieInfo : ${movieInfo}">
        <div class="detail-left">
          <div class="poster">
            <img th:src="${movieInfo?.posterUrl}" th:alt="${movieInfo?.title + ' 포스터'}"/>
          </div>
        </div>
        <div class="detail-right" >
          <h2>영화 정보</h2>
<!--          <form class="detail-form">-->
          <form action="/admin/update-movie" method="post" class="detail-form">
            <label for="">영화코드</label>
            <input type="test" name="movieNo" th:value="${movieInfo?.movieNo}" />
            <label for="">영화명(국문)</label>
            <input type="text" name="title" placeholder="영화명(국문)" th:value="${movieInfo?.title}" />
            <label for="">포스터Url</label>
            <input type="text" name="posterUrl" placeholder="포스터Url" th:value="${movieInfo?.posterUrl}" />
            <label for="">개봉일</label>
            <input type="text" name="ReleaseDate" placeholder="ex) 24-10-23" th:value="${movieInfo?.ReleaseDate}" />
            <label for="">상영시간</label>
            <input type="text" name="runningTime" placeholder="분단위 숫자만 입력 ex) 100" th:value="${movieInfo?.runningTime}" />
            <label for="">줄거리</label>
            <textarea
                    cols="30"
                    rows="10"
                    style="resize: none"
                    name="synopsis"
                    placeholder="줄거리"
                    th:text="${movieInfo?.synopsis}"
            ></textarea>
            <label for="">감독</label>
            <input type="text" name="director" placeholder="감독" th:value="${movieInfo?.director}" />
            <label for="">배우</label>
            <input type="text" name="actors" placeholder=",로 구분 ex) 김배우, 강배우, 이배우" th:value="${movieInfo?.actors}" />
            <label for="">장르</label>
            <input type="text" name="genre" placeholder=",로 구분 ex) 액션, 범죄" th:value="${movieInfo?.genre}" />
            <label for="">제작국가</label>
            <input type="text" name="productionCountry" placeholder=",로 구분 ex) 한국, 미국" th:value="${movieInfo?.productionCountry}" />
            <label for="">상영등급</label>
            <div class="category-info">
              <select name="rating" class="rating" >
                <option value="" disabled th:selected="${movieInfo?.rating == ''}">등급</option>
                <option value="NOT RATED" th:selected="${movieInfo?.rating == 'NOT RATED'}">등급 미정</option>
                <option value="ALl" th:selected="${movieInfo?.rating == 'ALL'}">전체관람가</option>
                <option value="12" th:selected="${movieInfo?.rating == '12'}">12세이상관람가</option>
                <option value="15" th:selected="${movieInfo?.rating == '15'}">15세이상관람가</option>
                <option value="19" th:selected="${movieInfo?.rating == '19'}">청소년관람불가</option>
              </select>
            </div>
            <label for="">상영상태</label>
            <div class="category-info">
              <select name="screeningStatus" class="screeningStatus">
                <option value="" disabled th:selected="${movieInfo?.screeningStatus == ''}">상영 상태</option>
                <option value="COMING SOON" th:selected="${movieInfo?.screeningStatus == 'COMING SOON'}">개봉예정</option>
                <option value="NOW SHOWING" th:selected="${movieInfo?.screeningStatus == 'NOW SHOWING'}">상영중</option>
                <option value="ON HOLD" th:selected="${movieInfo?.screeningStatus == 'ON HOLD'}">상영정지</option>
              </select>
            </div>
            <div>
              <div>
                  <h2>트레일러</h2>
                  <div th:if="${not #lists.isEmpty(movieInfo.trailers)}">
                    <div th:each="trailer : ${movieInfo.trailers}">
                        <div class="trailer-container">
                          <div class="remove-trailer-input">
                            <button type="button" class="remove-input-Btn">삭제</button>
                          </div>
                          <div class="add-Trailer">
                            <input type="hidden" name="trailerNo" th:value="${trailer.trailerNo}"/>
                            <label for="">트레일러 제목</label>
                            <input type="text" name="trailerType" placeholder="트레일러 제목" th:value="${trailer.trailerType}"/>
                            <label for="">트레일러 썸네일Url</label>
                            <input type="text" name="trailerThumbnailUrl" placeholder="썸네일Url" th:value="${trailer.trailerThumbnailUrl}"/>
                            <label for="">트레일러Url</label>
                            <input type="text" name="trailerUrl" placeholder="트레일러Url" th:value="${trailer.trailerUrl}"/>
                          </div>
                         </div>
                      </div>
                    </div>
                    <div id="trailerWrapper">
                      <!-- 트레일러 항목들이 여기에 추가됩니다 -->
                    </div>
                  <button type="button" id="addTrailer" class="addTrailer">트레일러 추가</button>

                  <h2>스틸컷</h2>
                  <div th:if="${not #lists.isEmpty(movieInfo.stillcuts)}">
                    <div th:each="stillcut : ${movieInfo.stillcuts}">
                      <div class="stillcut-container">
                        <div class="remove-stillcut-input">
                          <label for="">스틸컷Url</label>
                          <button type="button" class="remove-input-Btn">삭제</button>
                        </div>
                        <input type="hidden" name="stillcutNo" th:value="${stillcut.stillcutNo}"/>
                        <input type="text" name="stillcutUrl" placeholder="스틸컷Url" th:value="${stillcut.stillcutUrl}"/>
                      </div>
                    </div>
                  </div>
                  <div id="stillcutWrapper">
                    <!-- 스틸컷 항목들이 여기에 추가됩니다 -->
                  </div>
                  <button type="button" id="addStillcut" class="addStillcut">스틸컷 추가</button>
              </div>
            </div>

            <template id="trailerTemplate">
              <div class="trailer-container">
                <div class="remove-trailer-input">
                  <button type="button" class="remove-input-Btn">삭제</button>
                </div>
                <div class="add-Trailer">
                  <label for="">트레일러 제목</label>
                  <input type="text" name="trailerType" placeholder="트레일러 제목" />
                  <label for="">트레일러 썸네일Url</label>
                  <input type="text" name="trailerThumbnailUrl" placeholder="썸네일Url" />
                  <label for="">트레일러Url</label>
                  <input type="text" name="trailerUrl" placeholder="트레일러Url" />
                </div>
              </div>
            </template>

            <template id="stillcutTemplate">
              <div class="stillcut-container">
                <div class="remove-stillcut-input">
                  <label for="">스틸컷Url</label>
                  <button type="button" class="remove-input-Btn">삭제</button>
                </div>
                <input type="text" name="stillcutUrl" placeholder="스틸컷Url" />
              </div>
            </template>
            <button class="buttons modify" type="submit">수정</button>
<!--            <button class="buttons remove" type="button">삭제</button>-->
<!--            <button class="buttons cancel" type="button">취소</button>-->
          </form>
        </div>
      </div>
    </div>


  </main>
</div>
<th:block layout:fragment="script">
<!--     여기에 기존의 script 내용을 넣습니다-->
    <script>
      document.addEventListener('DOMContentLoaded', function () {
        const trailerWrapper = document.getElementById('trailerWrapper');
        const stillcutWrapper = document.getElementById('stillcutWrapper');
        const addTrailerBtn = document.getElementById('addTrailer');
        const addStillcutBtn = document.getElementById('addStillcut');

        function addTrailer() {
          const template = document.getElementById('trailerTemplate');
          const clone = document.importNode(template.content, true);
          trailerWrapper.appendChild(clone);
        }

        function addStillcut() {
          const template = document.getElementById('stillcutTemplate');
          const clone = document.importNode(template.content, true);
          stillcutWrapper.appendChild(clone);
        }

        addTrailerBtn.addEventListener('click', addTrailer);
        addStillcutBtn.addEventListener('click', addStillcut);

        document.addEventListener('click', function (e) {
          if (e.target && e.target.classList.contains('remove-input-Btn')) {
            const container =
                    e.target.closest('.trailer-container') || e.target.closest('.stillcut-container');
            if (container) {
              container.remove();
            }
          }
        });
      });
    </script>
</th:block>
</body>
</html>