<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="ko">
<head>
    <meta charset="UTF-8">
    <title>선물하기</title>
    <link rel="stylesheet" href="css/store/gift.css">
</head>
<body>
    <div class="container">
        <h1>선물하기</h1>
        <div class="progress-bar">
            <span class="step active">장바구니</span>
            <span class="step active">선물정보 입력</span>
            <span class="step">결제하기</span>
            <span class="step">결제완료</span>
        </div>

    <section class="product-info">
        <h2>구매 상품 정보</h2>
        <div class="product-item" th:each="product : ${gift.products}">
            <div class="product-details">
                <img th:if="${product.product != null and product.product.imageUrl != null}"
                     th:src="${product.product.imageUrl}"
                     th:alt="${product.product != null ? product.product.productName : '상품 이미지'}" />
                <h3 class="product-name" th:text="${product.product != null ? product.product.productName : '상품명 없음'}">상품명</h3>
                <p class="product-price" th:text="${#numbers.formatDecimal(product.price, 0, 'COMMA', 0, 'POINT')} + '원'">가격</p>
                <p class="product-quantity">수량: <span th:text="${product.quantity}"></span></p>
            </div>
        </div>
    </section>
        <form th:action="@{/store/gift/send}" method="post" th:object="${giftForm}">
            <section class="gift-message">
                <h2>선물 메시지 입력</h2>
                <select id="message-type">
                    <option value="preset">메시지 선택</option>
                    <option value="custom">직접 입력하기</option>
                </select>
                <textarea id="gift-message" th:text="${gift.message}" placeholder="선물과 함께 전달될 메시지를 입력해주세요(최대 100자)"></textarea>
            </section>

            <section class="recipient-info">
                <h2>선물 받는 분 정보</h2>
                <input type="text" id="recipient-name" th:value="${gift.recipientName}" placeholder="이름">
                <input type="tel" id="recipient-phone" th:value="${gift.recipientPhone}" placeholder="휴대폰 번호('-'없이 입력)">
                <button type="button" id="verify-recipient">확인</button>
            </section>

            <section class="price-summary">
                <h2>결제 금액</h2>
                <div class="price-details">
                    <p>총 상품 금액 <span id="total-price" th:text="${#numbers.formatDecimal(gift.totalAmount, 0, 'COMMA', 0, 'POINT')} + '원'"></span></p>
                    <p>총 할인 금액 <span id="discount-amount" th:text="${#numbers.formatDecimal(gift.totalDiscountAmount, 0, 'COMMA', 0, 'POINT')} + '원'"></span></p>
                    <p>총 결제 예정금액 <span id="final-price" th:text="${#numbers.formatDecimal(gift.finalAmount, 0, 'COMMA', 0, 'POINT')} + '원'"></span></p>
                </div>
            </section>

            <div class="action-buttons">
                <button type="button" id="back-button">이전단계</button>
                <button type="submit" id="next-button">다음</button>
            </div>
        </form>
    </div>

    <script src="/js/store/gift.js"></script>
</body>
</html>